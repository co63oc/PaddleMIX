# Copyright (c) 2024 PaddlePaddle Authors. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
import argparse

import paddle
import torch

paddle.set_device("cpu")

# i2v includes t2v
linear_list = [
    "model.diffusion_model.time_embed.0",
    "model.diffusion_model.time_embed.2",
    "model.diffusion_model.fps_embedding.0",
    "model.diffusion_model.fps_embedding.2",
    "model.diffusion_model.input_blocks.1.0.emb_layers.1",
    "model.diffusion_model.input_blocks.1.1.proj_in",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.1.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.1.1.proj_out",
    "model.diffusion_model.input_blocks.1.2.proj_in",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.1.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.1.2.proj_out",
    "model.diffusion_model.input_blocks.2.0.emb_layers.1",
    "model.diffusion_model.input_blocks.2.1.proj_in",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.2.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.2.1.proj_out",
    "model.diffusion_model.input_blocks.2.2.proj_in",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.2.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.2.2.proj_out",
    "model.diffusion_model.input_blocks.4.0.emb_layers.1",
    "model.diffusion_model.input_blocks.4.1.proj_in",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.4.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.4.1.proj_out",
    "model.diffusion_model.input_blocks.4.2.proj_in",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.4.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.4.2.proj_out",
    "model.diffusion_model.input_blocks.5.0.emb_layers.1",
    "model.diffusion_model.input_blocks.5.1.proj_in",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.5.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.5.1.proj_out",
    "model.diffusion_model.input_blocks.5.2.proj_in",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.5.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.5.2.proj_out",
    "model.diffusion_model.input_blocks.7.0.emb_layers.1",
    "model.diffusion_model.input_blocks.7.1.proj_in",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.7.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.7.1.proj_out",
    "model.diffusion_model.input_blocks.7.2.proj_in",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.7.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.7.2.proj_out",
    "model.diffusion_model.input_blocks.8.0.emb_layers.1",
    "model.diffusion_model.input_blocks.8.1.proj_in",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.input_blocks.8.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.input_blocks.8.1.proj_out",
    "model.diffusion_model.input_blocks.8.2.proj_in",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.input_blocks.8.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.input_blocks.8.2.proj_out",
    "model.diffusion_model.input_blocks.10.0.emb_layers.1",
    "model.diffusion_model.input_blocks.11.0.emb_layers.1",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.init_attn.0.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.middle_block.0.emb_layers.1",
    "model.diffusion_model.middle_block.1.proj_in",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.middle_block.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.middle_block.1.proj_out",
    "model.diffusion_model.middle_block.2.proj_in",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.middle_block.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.middle_block.2.proj_out",
    "model.diffusion_model.middle_block.3.emb_layers.1",
    "model.diffusion_model.output_blocks.0.0.emb_layers.1",
    "model.diffusion_model.output_blocks.1.0.emb_layers.1",
    "model.diffusion_model.output_blocks.2.0.emb_layers.1",
    "model.diffusion_model.output_blocks.3.0.emb_layers.1",
    "model.diffusion_model.output_blocks.3.1.proj_in",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.3.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.3.1.proj_out",
    "model.diffusion_model.output_blocks.3.2.proj_in",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.3.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.3.2.proj_out",
    "model.diffusion_model.output_blocks.4.0.emb_layers.1",
    "model.diffusion_model.output_blocks.4.1.proj_in",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.4.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.4.1.proj_out",
    "model.diffusion_model.output_blocks.4.2.proj_in",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.4.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.4.2.proj_out",
    "model.diffusion_model.output_blocks.5.0.emb_layers.1",
    "model.diffusion_model.output_blocks.5.1.proj_in",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.5.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.5.1.proj_out",
    "model.diffusion_model.output_blocks.5.2.proj_in",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.5.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.5.2.proj_out",
    "model.diffusion_model.output_blocks.6.0.emb_layers.1",
    "model.diffusion_model.output_blocks.6.1.proj_in",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.6.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.6.1.proj_out",
    "model.diffusion_model.output_blocks.6.2.proj_in",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.6.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.6.2.proj_out",
    "model.diffusion_model.output_blocks.7.0.emb_layers.1",
    "model.diffusion_model.output_blocks.7.1.proj_in",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.7.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.7.1.proj_out",
    "model.diffusion_model.output_blocks.7.2.proj_in",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.7.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.7.2.proj_out",
    "model.diffusion_model.output_blocks.8.0.emb_layers.1",
    "model.diffusion_model.output_blocks.8.1.proj_in",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.8.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.8.1.proj_out",
    "model.diffusion_model.output_blocks.8.2.proj_in",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.8.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.8.2.proj_out",
    "model.diffusion_model.output_blocks.9.0.emb_layers.1",
    "model.diffusion_model.output_blocks.9.1.proj_in",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.9.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.9.1.proj_out",
    "model.diffusion_model.output_blocks.9.2.proj_in",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.9.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.9.2.proj_out",
    "model.diffusion_model.output_blocks.10.0.emb_layers.1",
    "model.diffusion_model.output_blocks.10.1.proj_in",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.10.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.10.1.proj_out",
    "model.diffusion_model.output_blocks.10.2.proj_in",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.10.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.10.2.proj_out",
    "model.diffusion_model.output_blocks.11.0.emb_layers.1",
    "model.diffusion_model.output_blocks.11.1.proj_in",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_k_ip",
    "model.diffusion_model.output_blocks.11.1.transformer_blocks.0.attn2.to_v_ip",
    "model.diffusion_model.output_blocks.11.1.proj_out",
    "model.diffusion_model.output_blocks.11.2.proj_in",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn1.to_q",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn1.to_k",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn1.to_v",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn1.to_out.0",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.ff.net.0.proj",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.ff.net.2",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn2.to_q",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn2.to_k",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn2.to_v",
    "model.diffusion_model.output_blocks.11.2.transformer_blocks.0.attn2.to_out.0",
    "model.diffusion_model.output_blocks.11.2.proj_out",
    "cond_stage_model.model.transformer.resblocks.0.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.0.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.0.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.1.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.1.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.1.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.2.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.2.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.2.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.3.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.3.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.3.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.4.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.4.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.4.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.5.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.5.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.5.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.6.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.6.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.6.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.7.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.7.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.7.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.8.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.8.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.8.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.9.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.9.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.9.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.10.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.10.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.10.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.11.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.11.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.11.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.12.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.12.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.12.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.13.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.13.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.13.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.14.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.14.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.14.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.15.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.15.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.15.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.16.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.16.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.16.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.17.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.17.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.17.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.18.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.18.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.18.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.19.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.19.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.19.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.20.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.20.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.20.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.21.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.21.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.21.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.22.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.22.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.22.mlp.c_proj",
    "cond_stage_model.model.transformer.resblocks.23.attn.out_proj",
    "cond_stage_model.model.transformer.resblocks.23.mlp.c_fc",
    "cond_stage_model.model.transformer.resblocks.23.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.0.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.0.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.0.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.1.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.1.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.1.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.2.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.2.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.2.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.3.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.3.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.3.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.4.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.4.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.4.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.5.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.5.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.5.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.6.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.6.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.6.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.7.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.7.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.7.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.8.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.8.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.8.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.9.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.9.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.9.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.10.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.10.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.10.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.11.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.11.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.11.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.12.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.12.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.12.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.13.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.13.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.13.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.14.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.14.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.14.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.15.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.15.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.15.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.16.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.16.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.16.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.17.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.17.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.17.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.18.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.18.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.18.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.19.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.19.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.19.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.20.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.20.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.20.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.21.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.21.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.21.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.22.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.22.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.22.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.23.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.23.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.23.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.24.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.24.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.24.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.25.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.25.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.25.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.26.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.26.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.26.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.27.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.27.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.27.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.28.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.28.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.28.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.29.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.29.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.29.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.30.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.30.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.30.mlp.c_proj",
    "embedder.model.visual.transformer.resblocks.31.attn.out_proj",
    "embedder.model.visual.transformer.resblocks.31.mlp.c_fc",
    "embedder.model.visual.transformer.resblocks.31.mlp.c_proj",
    "image_proj_model.proj_in",
    "image_proj_model.proj_out",
    "image_proj_model.layers.0.0.to_q",
    "image_proj_model.layers.0.0.to_kv",
    "image_proj_model.layers.0.0.to_out",
    "image_proj_model.layers.0.1.1",
    "image_proj_model.layers.0.1.3",
    "image_proj_model.layers.1.0.to_q",
    "image_proj_model.layers.1.0.to_kv",
    "image_proj_model.layers.1.0.to_out",
    "image_proj_model.layers.1.1.1",
    "image_proj_model.layers.1.1.3",
    "image_proj_model.layers.2.0.to_q",
    "image_proj_model.layers.2.0.to_kv",
    "image_proj_model.layers.2.0.to_out",
    "image_proj_model.layers.2.1.1",
    "image_proj_model.layers.2.1.3",
    "image_proj_model.layers.3.0.to_q",
    "image_proj_model.layers.3.0.to_kv",
    "image_proj_model.layers.3.0.to_out",
    "image_proj_model.layers.3.1.1",
    "image_proj_model.layers.3.1.3",
]


def convert_to_ppdiffusers(vae_or_unet, dtype=None):
    need_transpose = []
    for k, v in vae_or_unet["state_dict"].items():
        if k.replace(".weight", "") in linear_list:
            need_transpose.append(k)
        if "in_proj_weight" in k:
            need_transpose.append(k)

    new_vae_or_unet = {}
    for k, v in vae_or_unet["state_dict"].items():
        if not isinstance(v, torch.Tensor):
            print(v)
            continue
        if k not in need_transpose:
            v2 = v
        else:
            v2 = v.t()
        new_vae_or_unet[k] = paddle.to_tensor(v2.cpu().numpy())
        if dtype is not None:
            new_vae_or_unet[k] = new_vae_or_unet[k].astype(dtype)
    return {"state_dict": new_vae_or_unet}


def convert_diffusers_stable_diffusion_to_ppdiffusers(pretrained_model_name_or_path, output_path=None, dtype=None):
    model = torch.load(pretrained_model_name_or_path)
    state_dict = convert_to_ppdiffusers(model, dtype=None)
    paddle.save(state_dict, output_path)


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Pytorch model weights to Paddle model weights.")
    parser.add_argument(
        "--pretrained_path",
        type=str,
        default="/data/VideoCrafter/checkpoints/i2v_512_v1/model.ckpt",
        help="Path to pretrained model or model identifier from huggingface.co/models.",
    )
    parser.add_argument(
        "--output_path",
        type=str,
        default="checkpoints/i2v_512_v1/model.ckpt",
        help="The model output path.",
    )
    # args = parser.parse_args()
    # convert_diffusers_stable_diffusion_to_ppdiffusers(args.pretrained_path, args.output_path)

    # convert_diffusers_stable_diffusion_to_ppdiffusers(
    #     "/nfs/model/VideoCrafter/model.ckpt",
    #     "checkpoints/base_512_v2/model.ckpt",
    # )
    # print("1")

    convert_diffusers_stable_diffusion_to_ppdiffusers(
        "/nfs/model/ImageVideo/model.ckpt",
        "checkpoints/i2v_512_v1/model.ckpt",
    )
    print("2")
